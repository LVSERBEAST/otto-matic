<div class="animate-fade-in">
  <!-- Collapsible Stats -->
  <div class="mb-6">
    <button 
      class="flex items-center justify-between w-full p-3 rounded-lg transition-all"
      style="background: var(--surface-medium); border: 1px solid var(--border-medium);"
      (click)="statsCollapsed.set(!statsCollapsed())">
      <h2 class="text-base font-semibold" style="color: var(--text-primary);">Overview Stats</h2>
      <svg class="w-4 h-4 transition-transform" [class.rotate-180]="!statsCollapsed()" style="color: var(--text-secondary);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
      </svg>
    </button>
    
    @if (!statsCollapsed()) {
    <div class="mt-3 stats-grid">
    <div class="stat-card">
      <div class="stat-value">{{ quotes().length }}</div>
      <div class="stat-label">Total Quotes</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">{{ getTotalValue() | currency : 'USD' : 'symbol' : '1.0-0' }}</div>
      <div class="stat-label">Total Value</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">{{ getPendingCount() }}</div>
      <div class="stat-label">Pending Quotes</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">{{ getAvgQuoteValue() | currency : 'USD' : 'symbol' : '1.0-0' }}</div>
      <div class="stat-label">Avg Quote Value</div>
    </div>
    </div>
  }

  <!-- Detailed Quotes Table -->
  <div class="card mb-8">
    <div class="card-header">
      <h3 class="card-title">All Quotes</h3>
      <div class="flex gap-2">
        <button class="btn btn-ghost">Filter by Client</button>
        <button class="btn btn-ghost">Filter by Date</button>
        <button class="btn btn-ghost">Export Selected</button>
      </div>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full">
        <thead>
          <tr class="border-b border-white/10">
            <th class="text-left p-4 font-medium text-neutral-400">Quote ID</th>
            <th class="text-left p-4 font-medium text-neutral-400">Client</th>
            <th class="text-left p-4 font-medium text-neutral-400">Material</th>
            <th class="text-left p-4 font-medium text-neutral-400">Process</th>
            <th class="text-left p-4 font-medium text-neutral-400">Quantity</th>
            <th class="text-left p-4 font-medium text-neutral-400">Total</th>
            <th class="text-left p-4 font-medium text-neutral-400">Date</th>
            <th class="text-left p-4 font-medium text-neutral-400">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (quote of quotes(); track quote.quoteId) {
          <tr class="border-b border-white/5 hover:bg-white/2">
            <td class="p-4 font-mono text-sm">{{ quote.quoteId.substring(0, 8) }}</td>
            <td class="p-4">{{ quote.clientName }}</td>
            <td class="p-4">{{ quote.material }}</td>
            <td class="p-4">{{ quote.finishType }}</td>
            <td class="p-4">{{ quote.quantity }}</td>
            <td class="p-4 font-semibold">{{ quote.totalPrice | currency }}</td>
            <td class="p-4 text-sm text-neutral-400">{{ quote.quoteDate }}</td>
            <td class="p-4">
              <div class="flex gap-2">
                <button class="btn btn-ghost btn-sm" (click)="editQuote(quote)">Edit</button>
                <button class="btn btn-primary btn-sm" (click)="convertToJob(quote)">
                  Create Job
                </button>
                <button class="btn btn-outline btn-sm" (click)="deleteQuote(quote.quoteId)">
                  Delete
                </button>
              </div>
            </td>
          </tr>
          } @empty {
          <tr>
            <td colspan="8" class="text-center py-12 text-neutral-400">
              <p class="mb-4">No quotes found</p>
              <p class="text-sm">Start by creating your first quote above</p>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="dashboard-grid">
    <!-- Quote Form -->
    <div class="dashboard-main">
      <app-quote-form (submitted)="createQuote($event)" />
    </div>

    <!-- Recent Quotes Sidebar -->
    <div class="dashboard-sidebar">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Recent Quotes</h3>
          <div class="card-subtitle">Latest pricing requests</div>
        </div>

        <div class="flex flex-col gap-3">
          @for (quote of getRecentQuotes().slice(0, 8); track quote.quoteId) {
          <div class="quote-card">
            <div class="quote-client">{{ quote.clientName }}</div>
            <div class="quote-title">{{ quote.material }}</div>
            <div class="quote-details">{{ quote.finishType }} â€¢ {{ quote.quantity }} qty</div>
            @if (quote.size) {
            <div class="quote-details">{{ quote.size }}</div>
            }
            <div class="quote-price">{{ quote.totalPrice | currency }}</div>

            <div class="flex items-center justify-between mt-3">
              <span class="text-xs px-2 py-1 rounded bg-amber-500/20 text-amber-300"> Quoted </span>
              <div class="flex gap-2">
                <button
                  class="btn btn-ghost"
                  style="padding: 4px 8px; font-size: 12px"
                  (click)="editQuote(quote)"
                >
                  Edit
                </button>
                <button
                  class="btn btn-primary"
                  style="padding: 4px 8px; font-size: 12px"
                  (click)="convertToJob(quote)"
                >
                  Create Job
                </button>
              </div>
            </div>
          </div>
          } @empty {
          <div class="text-center py-8 opacity-75">
            <p class="mb-4">No quotes yet</p>
            <p class="text-sm">Create your first quote using the form</p>
          </div>
          }
        </div>
      </div>

      <!-- Quote Templates -->
      <div class="card mt-6">
        <div class="card-header">
          <h3 class="card-title">Quick Templates</h3>
          <div class="card-subtitle">Common quote types</div>
        </div>

        <div class="flex flex-col gap-2">
          <button
            class="btn btn-ghost w-full justify-start"
            (click)="loadTemplate('business-cards')"
          >
            <span>ðŸ’¼</span>
            Business Cards
          </button>
          <button class="btn btn-ghost w-full justify-start" (click)="loadTemplate('invitations')">
            <span>ðŸ’Œ</span>
            Wedding Invitations
          </button>
          <button class="btn btn-ghost w-full justify-start" (click)="loadTemplate('menus')">
            <span>ðŸ“„</span>
            Restaurant Menus
          </button>
          <button class="btn btn-ghost w-full justify-start" (click)="loadTemplate('posters')">
            <span>ðŸŽ¨</span>
            Posters & Prints
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

